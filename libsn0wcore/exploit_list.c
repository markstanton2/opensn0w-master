/*
 * Exploit list module thing what I don't know
 */

#include "core.h"

sn0w_list_t exploits;

exploit_info_t* exploit_info_create(void)
{
	exploit_info_t* i = malloc(sizeof(exploit_info_t));
	if(!i) {
		printf("Failed to create exploit information node\n");
		return  NULL;
	}
	memset(i, 0, sizeof(exploit_info_t));
	return i;
}

int exploit_add_handler(exploit_function_t handler, chip_type_t chip, state_t state)
{
	exploit_info_t *i = exploit_info_create();
	if(!i) {
		printf("Failed to allocate node\n");
		return -1;
	}

	i->handler = handler;
	i->compatible_chip = chip;
	i->state = state;

	printf("exploit_add_handler(): Added exploit for S5L%dX, handler at %p\n", chip, handler);

	sn0w_node_add(i, sn0w_node_create(), &exploits);

	return 0;
}
