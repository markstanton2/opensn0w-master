/*
 * Exploit handler definitions
 */

#ifndef _exploit_h_
#define _exploit_h_


typedef int (*exploit_function_t)(void);

typedef struct _exploitinfo {
    exploit_function_t handler;
    int compatible_chip;
    int state;
} exploit_info_t;

typedef enum {
    S5L8900 = 8900u,
    S5L8720 = 8720u,
    S5L8920 = 8920u,
    S5L8922 = 8922u,
    S5L8930 = 8930u,
    S5L8940 = 8940u,
    S5L8945 = 8945u,
    S5L8950 = 8950u
} chip_type_t;

typedef enum {
    kDFU = 0,
    kIBSS,
    kIBEC,
    kIBOOT,
    kUSER
} state_t;

extern sn0w_list_t exploits;
int exploit_add_handler(exploit_function_t handler, chip_type_t chip, state_t state);


#endif
